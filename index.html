<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Status updates for the UCF Materia application">
	<title>Materia Status</title>
	<link rel="stylesheet" href="styles.css" />
</head>
<body>
	<div class="container">
		<header>
			<h1>Materia Status</h1>
			<p>Current status and updates for the UCF Materia application</p>
		</header>

		<div class="status-banner" id="mainStatus">
			<div class="status-indicator">
				<div class="status-dot" id="statusDot"></div>
				<h2 class="status-title" id="statusTitle">All Systems Operational</h2>
			</div>
			<p class="status-description" id="statusDescription">All services are running normally.</p>
		</div>

		<div class="maintenance-summary-section">
			<h2>Maintenance Schedule</h2>
			<p>
				Materia undergoes routine maintenance to ensure optimal performance and security. 
				Scheduled maintenance windows are typically announced at least 48 hours in advance. 
				During maintenance, you may experience brief service interruptions. We appreciate 
				your patience as we work to keep Materia running smoothly.
			</p>
			<p>
				For the most current maintenance information, please check this page or subscribe 
				to our notifications.
			</p>
		</div>

		<div class="maintenance-section" id="maintenanceSection" style="display: none;">
			<h2>Updates</h2>
			<div id="maintenanceList">
				<!-- Maintenance updates will be loaded here -->
			</div>
		</div>

		<div class="faq-section">
			<h2>Frequently Asked Questions</h2>
			<div id="faqList">
				<!-- FAQ items will be loaded here -->
			</div>
		</div>

		<div class="last-updated" id="lastUpdated">
			Last updated: <span id="updateTime">Loading...</span>
		</div>

		<footer>
			<p>
				Materia Status Page | 
				<a href="https://github.com/ucfopen/Materia" target="_blank">Materia on GitHub</a> | 
				<a href="https://ucfopen.github.io/Materia-Docs/" target="_blank">Documentation</a>
			</p>
		</footer>
	</div>

	<script>
		// Default status data configuration (fallback if status.json is not available)
		let statusData = {
			overallStatus: 'operational', // operational, degraded, outage, maintenance
			statusMessage: 'All services are running normally.',
			maintenanceUpdates: [],
			faq: [
				{
					question: 'What is Materia?',
					answer: 'Materia is a learning tool creation platform used at UCF to create and deploy interactive learning widgets.'
				},
				{
					question: 'How do I report an issue?',
					answer: 'Please contact support through your institution\'s help desk or email support@materia.ucf.edu.'
				},
				{
					question: 'Where can I find documentation?',
					answer: 'Full documentation is available at https://ucfopen.github.io/Materia-Docs/'
				}
			]
		};

		// Status titles
		const statusTitles = {
			operational: 'All Systems Operational',
			degraded: 'Degraded Performance',
			outage: 'Service Outage',
			maintenance: 'Scheduled Maintenance'
		};

		// Load status data from external JSON file
		async function loadStatusData() {
			try {
				const response = await fetch('status.json');
				if (response.ok) {
					const data = await response.json();
					statusData = data;
					console.log('Status data loaded from status.json');
				} else {
					console.log('Could not load status.json, using default data');
				}
			} catch (error) {
				console.log('Could not load status.json, using default data:', error.message);
			}
		}

		// Initialize the page
		async function init() {
			await loadStatusData();
			updateOverallStatus();
			renderMaintenanceUpdates();
			renderFAQ();
			updateTimestamp();
		}

		// Update overall status banner
		function updateOverallStatus() {
			const banner = document.getElementById('mainStatus');
			const dot = document.getElementById('statusDot');
			const title = document.getElementById('statusTitle');
			const description = document.getElementById('statusDescription');

			const status = statusData.overallStatus;
			const statusTitle = statusTitles[status] || 'Status Unknown';

			// Update classes
			banner.className = 'status-banner ' + status;
			dot.className = 'status-dot ' + status;

			// Update text
			title.textContent = statusTitle;
			description.textContent = statusData.statusMessage || 'Status information unavailable.';
		}

		// Render maintenance updates
		function renderMaintenanceUpdates() {
			const maintenanceSection = document.getElementById('maintenanceSection');
			const maintenanceList = document.getElementById('maintenanceList');

			if (!statusData.maintenanceUpdates || statusData.maintenanceUpdates.length === 0) {
				maintenanceSection.style.display = 'none';
				return;
			}

			maintenanceSection.style.display = 'block';
			maintenanceList.innerHTML = '';

			statusData.maintenanceUpdates.forEach(update => {
				const updateDiv = document.createElement('div');
				updateDiv.className = 'maintenance-update';

				const date = document.createElement('div');
				date.className = 'update-date';
				date.textContent = update.date;

				const message = document.createElement('p');
				message.className = 'update-message';
				message.textContent = update.message;

				updateDiv.appendChild(date);
				updateDiv.appendChild(message);

				maintenanceList.appendChild(updateDiv);
			});
		}

		// Render FAQ items
		function renderFAQ() {
			const faqList = document.getElementById('faqList');
			faqList.innerHTML = '';

			if (!statusData.faq || statusData.faq.length === 0) {
				faqList.innerHTML = '<p class="no-faq">No FAQ items available.</p>';
				return;
			}

			statusData.faq.forEach(item => {
				const faqItem = document.createElement('div');
				faqItem.className = 'faq-item';

				const question = document.createElement('div');
				question.className = 'faq-question';
				question.textContent = item.question;

				const answer = document.createElement('div');
				answer.className = 'faq-answer';
				answer.textContent = item.answer;

				faqItem.appendChild(question);
				faqItem.appendChild(answer);

				faqList.appendChild(faqItem);
			});
		}

		// Update timestamp
		function updateTimestamp() {
			const updateTime = document.getElementById('updateTime');
			const now = new Date();
			updateTime.textContent = now.toLocaleString('en-US', {
				year: 'numeric',
				month: 'long',
				day: 'numeric',
				hour: '2-digit',
				minute: '2-digit',
				timeZoneName: 'short'
			});
		}

		// Initialize on page load
		document.addEventListener('DOMContentLoaded', init);

		// Auto-refresh every 5 minutes to check for status updates
		setInterval(async () => {
			await loadStatusData();
			updateOverallStatus();
			renderMaintenanceUpdates();
			renderFAQ();
			updateTimestamp();
		}, 300000);
	</script>
</body>
</html>
